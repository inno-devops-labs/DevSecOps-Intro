                    
                    
┌──────────────────┐
│ 95 Code Findings │
└──────────────────┘
                           
    /src/config/default.yml
   ❯❯❱ rules.generic.secrets.security.detected-google-oauth-url
          Google OAuth url detected
                                   
           59┆ clientId: '1005568560502-6hm16lef8oh46hr2d98vf2ohlnj4nfhq.apps.googleusercontent.com'
                          
    /src/cypress.config.ts
    ❯❱ rules.javascript.lang.best-practice.lazy-load-module
          Lazy loading can complicate code bundling if care is not taken, also `require`s are run         
          synchronously by Node.js. If they are called from within a function, it may block other requests
          from being handled at a more critical time. The best practice is to `require` modules at the    
          beginning of each file, before and outside of any functions.                                    
                                                                                                          
           39┆ const trainingData = require(`data/chatbot/${utils.extractFilename(
           40┆   config.get('application.chatBot.trainingData')
           41┆ )}`)
                                                     
    /src/data/static/codefixes/dbSchemaChallenge_1.ts
    ❯❱ rules.javascript.sequelize.security.audit.sequelize-raw-query
          Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL
          Injection. Data replacement or data binding should be used. See                                     
          https://sequelize.org/master/manual/raw-queries.html                                                
                                                                                                              
            5┆ models.sequelize.query("SELECT * FROM Products WHERE ((name LIKE '%"+criteria+"%' OR
               description LIKE '%"+criteria+"%') AND deletedAt IS NULL) ORDER BY name")           
   
   ❯❯❱ rules.javascript.sequelize.security.audit.express-sequelize-injection
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
                                                                                                              
            5┆ models.sequelize.query("SELECT * FROM Products WHERE ((name LIKE '%"+criteria+"%' OR
               description LIKE '%"+criteria+"%') AND deletedAt IS NULL) ORDER BY name")           
   
   ❯❯❱ rules.javascript.express.security.injection.tainted-sql-string
          Detected user input used to manually construct a SQL string. This is usually bad practice because 
          manual construction could accidentally result in a SQL injection. An attacker could use a SQL     
          injection to steal or modify contents of the database. Instead, use a parameterized query which is
          available by default in most database engines. Alternatively, consider using an object-relational 
          mapper (ORM) such as Sequelize which will protect your queries.                                   
                                                                                                            
            5┆ models.sequelize.query("SELECT * FROM Products WHERE ((name LIKE '%"+criteria+"%' OR
               description LIKE '%"+criteria+"%') AND deletedAt IS NULL) ORDER BY name")           
                                                     
    /src/data/static/codefixes/dbSchemaChallenge_3.ts
    ❯❱ rules.javascript.sequelize.security.audit.sequelize-raw-query
          Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL
          Injection. Data replacement or data binding should be used. See                                     
          https://sequelize.org/master/manual/raw-queries.html                                                
                                                                                                              
           11┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
   
   ❯❯❱ rules.javascript.sequelize.security.audit.express-sequelize-injection
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
                                                                                                              
           11┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
   
   ❯❯❱ rules.javascript.express.security.injection.tainted-sql-string
          Detected user input used to manually construct a SQL string. This is usually bad practice because 
          manual construction could accidentally result in a SQL injection. An attacker could use a SQL     
          injection to steal or modify contents of the database. Instead, use a parameterized query which is
          available by default in most database engines. Alternatively, consider using an object-relational 
          mapper (ORM) such as Sequelize which will protect your queries.                                   
                                                                                                            
           11┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
                                                       
    /src/data/static/codefixes/restfulXssChallenge_2.ts
     ❱ rules.javascript.audit.detect-replaceall-sanitization
          Detected a call to `replaceAll()` in an attempt to HTML escape the string                        
          `tableData[i].description`. Manually sanitizing input through a manually built list can be       
          circumvented in many situations, and it's better to use a well known sanitization library such as
          `sanitize-html` or `DOMPurify`.                                                                  
                                                                                                           
           62┆ tableData[i].description = tableData[i].description.replaceAll('<', '&lt;').replaceAll('>',
               '&gt;')                                                                                    
   
    ❯❱ rules.javascript.lang.correctness.no-replaceall
          The string method replaceAll is not supported in all versions of javascript, and is not supported by
          older browser versions. Consider using replace() with a regex as the first argument instead like    
          mystring.replace(/bad/g, "good") instead of mystring.replaceAll("bad", "good")                      
          (https://discourse.threejs.org/t/replaceall-is-not-a-function/14585)                                
                                                                                                              
           62┆ tableData[i].description = tableData[i].description.replaceAll('<', '&lt;').replaceAll('>',
               '&gt;')                                                                                    
   
     ❱ rules.javascript.audit.detect-replaceall-sanitization
          Detected a call to `replaceAll()` in an attempt to HTML escape the string                          
          `tableData[i].description.replaceAll('<', '&lt;')`. Manually sanitizing input through a manually   
          built list can be circumvented in many situations, and it's better to use a well known sanitization
          library such as `sanitize-html` or `DOMPurify`.                                                    
                                                                                                             
           62┆ tableData[i].description = tableData[i].description.replaceAll('<', '&lt;').replaceAll('>',
               '&gt;')                                                                                    
   
    ❯❱ rules.javascript.lang.correctness.no-replaceall
          The string method replaceAll is not supported in all versions of javascript, and is not supported by
          older browser versions. Consider using replace() with a regex as the first argument instead like    
          mystring.replace(/bad/g, "good") instead of mystring.replaceAll("bad", "good")                      
          (https://discourse.threejs.org/t/replaceall-is-not-a-function/14585)                                
                                                                                                              
           62┆ tableData[i].description = tableData[i].description.replaceAll('<', '&lt;').replaceAll('>',
               '&gt;')                                                                                    
                                                              
    /src/data/static/codefixes/unionSqlInjectionChallenge_1.ts
    ❯❱ rules.javascript.sequelize.security.audit.sequelize-raw-query
          Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL
          Injection. Data replacement or data binding should be used. See                                     
          https://sequelize.org/master/manual/raw-queries.html                                                
                                                                                                              
            6┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
   
   ❯❯❱ rules.javascript.sequelize.security.audit.express-sequelize-injection
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
                                                                                                              
            6┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
   
   ❯❯❱ rules.javascript.express.security.injection.tainted-sql-string
          Detected user input used to manually construct a SQL string. This is usually bad practice because 
          manual construction could accidentally result in a SQL injection. An attacker could use a SQL     
          injection to steal or modify contents of the database. Instead, use a parameterized query which is
          available by default in most database engines. Alternatively, consider using an object-relational 
          mapper (ORM) such as Sequelize which will protect your queries.                                   
                                                                                                            
            6┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
                                                              
    /src/data/static/codefixes/unionSqlInjectionChallenge_3.ts
    ❯❱ rules.javascript.sequelize.security.audit.sequelize-raw-query
          Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL
          Injection. Data replacement or data binding should be used. See                                     
          https://sequelize.org/master/manual/raw-queries.html                                                
                                                                                                              
           10┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
   
   ❯❯❱ rules.javascript.sequelize.security.audit.express-sequelize-injection
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
                                                                                                              
           10┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
   
   ❯❯❱ rules.javascript.express.security.injection.tainted-sql-string
          Detected user input used to manually construct a SQL string. This is usually bad practice because 
          manual construction could accidentally result in a SQL injection. An attacker could use a SQL     
          injection to steal or modify contents of the database. Instead, use a parameterized query which is
          available by default in most database engines. Alternatively, consider using an object-relational 
          mapper (ORM) such as Sequelize which will protect your queries.                                   
                                                                                                            
           10┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)           
                              
    /src/data/static/users.yml
     ❱ rules.generic.secrets.gitleaks.generic-api-key
          A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is   
          not recommended to store credentials in source-code, as this risks secrets being leaked  and used by
          either an internal or external malicious adversary. It is recommended to use  environment variables 
          to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware       
          Security Module). This rule can introduce a lot of false positives,  it is not recommended to be    
          used in PR comments.                                                                                
                                                                                                              
           88┆ password: 'bW9jLmxpYW1nQGhjaW5pbW1pay5ucmVvamI='
   
   ❯❯❱ rules.generic.secrets.security.detected-generic-secret
          Generic Secret detected
                                 
          150┆ totpSecret: IFTXE3SPOEYVURT2MRYGI52TKJ4HC3KH
   
     ❱ rules.generic.secrets.gitleaks.generic-api-key
          A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is   
          not recommended to store credentials in source-code, as this risks secrets being leaked  and used by
          either an internal or external malicious adversary. It is recommended to use  environment variables 
          to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware       
          Security Module). This rule can introduce a lot of false positives,  it is not recommended to be    
          used in PR comments.                                                                                
                                                                                                              
          150┆ totpSecret: IFTXE3SPOEYVURT2MRYGI52TKJ4HC3KH
                                                  
    /src/frontend/src/app/about/about.component.ts
    ❯❱ rules.javascript.lang.security.html-in-template-string
          This template literal looks like HTML and has interpolated variables. These variables are not HTML-
          encoded by default. If the variables contain HTML tags, these may be interpreted by the browser,   
          resulting in cross-site scripting (XSS).                                                           
                                                                                                             
          118┆ feedbacks[i].comment = `<span style="width: 90%; display:block;">${
          119┆   feedbacks[i].comment
          120┆ }<br/> (${this.stars[feedbacks[i].rating]})</span>`
                                                                    
    /src/frontend/src/app/administration/administration.component.ts
    ❯❱ rules.javascript.lang.security.html-in-template-string
          This template literal looks like HTML and has interpolated variables. These variables are not HTML-
          encoded by default. If the variables contain HTML tags, these may be interpreted by the browser,   
          resulting in cross-site scripting (XSS).                                                           
                                                                                                             
           57┆ user.email = this.sanitizer.bypassSecurityTrustHtml(`<span        
               class="${this.doesUserHaveAnActiveSession(user) ? 'confirmation' :
               'error'}">${user.email}</span>`)                                  
                                           
    /src/frontend/src/app/app.guard.spec.ts
   ❯❯❱ rules.generic.secrets.security.detected-jwt-token
          JWT token detected
                            
           38┆ localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODk
               wIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQs
               sw5c')                                                                                     
   
     ❱ rules.generic.secrets.gitleaks.jwt
          A gitleaks jwt was detected which attempts to identify hard-coded credentials. It is not recommended
          to store credentials in source-code, as this risks secrets being leaked and used by either an       
          internal or external malicious adversary. It is recommended to use environment variables to securely
          provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).  
                                                                                                              
           38┆ localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODk
               wIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQs
               sw5c')                                                                                     
                                                                       
    /src/frontend/src/app/last-login-ip/last-login-ip.component.spec.ts
   ❯❯❱ rules.generic.secrets.security.detected-jwt-token
          JWT token detected
                            
           61┆ localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7Imxhc3RMb2d
               pbklwIjoiMS4yLjMuNCJ9fQ.RAkmdqwNypuOxv3SDjPO4xMKvd1CddKvDFYDBfUt3bg')                      
   
     ❱ rules.generic.secrets.gitleaks.jwt
          A gitleaks jwt was detected which attempts to identify hard-coded credentials. It is not recommended
          to store credentials in source-code, as this risks secrets being leaked and used by either an       
          internal or external malicious adversary. It is recommended to use environment variables to securely
          provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).  
                                                                                                              
           61┆ localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7Imxhc3RMb2d
               pbklwIjoiMS4yLjMuNCJ9fQ.RAkmdqwNypuOxv3SDjPO4xMKvd1CddKvDFYDBfUt3bg')                      
   
   ❯❯❱ rules.generic.secrets.security.detected-jwt-token
          JWT token detected
                            
           67┆ localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7fX0.bVBhvll
               6IaeR3aUdoOeyR8YZe2S2DfhGAxTGfd9enLw')                                                     
                                                                  
    /src/frontend/src/app/last-login-ip/last-login-ip.component.ts
    ❯❱ rules.javascript.lang.security.html-in-template-string
          This template literal looks like HTML and has interpolated variables. These variables are not HTML-
          encoded by default. If the variables contain HTML tags, these may be interpreted by the browser,   
          resulting in cross-site scripting (XSS).                                                           
                                                                                                             
           38┆ this.lastLoginIp =                                                                  
               this.sanitizer.bypassSecurityTrustHtml(`<small>${payload.data.lastLoginIp}</small>`)
                                                  
    /src/frontend/src/app/login/login.component.ts
   ❯❯❱ rules.generic.secrets.security.detected-google-oauth-url
          Google OAuth url detected
                                   
           48┆ public clientId =                                                          
               '1005568560502-6hm16lef8oh46hr2d98vf2ohlnj4nfhq.apps.googleusercontent.com'
                                                      
    /src/frontend/src/app/navbar/navbar.component.html
    ❯❱ rules.generic.html-templates.security.unquoted-attribute-var
          Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject
          custom JavaScript handlers. To fix this, add quotes around the template expression, like this: "{{
          expr }}".                                                                                         
                                                                                                            
           17┆ <img [src]="logoSrc" class="logo" alt={{applicationName}}>
                                                       
    /src/frontend/src/app/oauth/oauth.component.spec.ts
     ❱ rules.generic.secrets.gitleaks.generic-api-key
          A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is   
          not recommended to store credentials in source-code, as this risks secrets being leaked  and used by
          either an internal or external malicious adversary. It is recommended to use  environment variables 
          to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware       
          Security Module). This rule can introduce a lot of false positives,  it is not recommended to be    
          used in PR comments.                                                                                
                                                                                                              
           84┆ expect(userService.save).toHaveBeenCalledWith({ email: 'test@test.com', password:
               'bW9jLnRzZXRAdHNldA==', passwordRepeat: 'bW9jLnRzZXRAdHNldA==' })                
            ⋮┆----------------------------------------
           84┆ expect(userService.save).toHaveBeenCalledWith({ email: 'test@test.com', password:
               'bW9jLnRzZXRAdHNldA==', passwordRepeat: 'bW9jLnRzZXRAdHNldA==' })                
            ⋮┆----------------------------------------
           91┆ expect(userService.login).toHaveBeenCalledWith({ email: 'test@test.com', password:
               'bW9jLnRzZXRAdHNldA==', oauth: true })                                            
                                                                        
    /src/frontend/src/app/purchase-basket/purchase-basket.component.html
    ❯❱ rules.generic.html-templates.security.unquoted-attribute-var
          Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject
          custom JavaScript handlers. To fix this, add quotes around the template expression, like this: "{{
          expr }}".                                                                                         
                                                                                                            
           15┆ <img [src]="'assets/public/images/products/'+element.image" alt={{element.name}}
                                                                    
    /src/frontend/src/app/search-result/search-result.component.html
    ❯❱ rules.generic.html-templates.security.unquoted-attribute-var
          Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject
          custom JavaScript handlers. To fix this, add quotes around the template expression, like this: "{{
          expr }}".                                                                                         
                                                                                                            
           40┆ <img mat-card-image [src]="'assets/public/images/products/'+item.image" alt={{item.name}}
                                                                
    /src/frontend/src/app/track-result/track-result.component.ts
    ❯❱ rules.javascript.lang.security.html-in-template-string
          This template literal looks like HTML and has interpolated variables. These variables are not HTML-
          encoded by default. If the variables contain HTML tags, these may be interpreted by the browser,   
          resulting in cross-site scripting (XSS).                                                           
                                                                                                             
           45┆ this.results.orderNo =                                                           
               this.sanitizer.bypassSecurityTrustHtml(`<code>${results.data[0].orderId}</code>`)
                                                                
    /src/frontend/src/app/web3-sandbox/web3-sandbox.component.ts
     ❱ rules.javascript.lang.correctness.missing-template-string-indicator
          This looks like a JavaScript template string. Are you missing a '$' in front of '{...}'?
                                                                                                  
           73┆   code: string = `// SPDX-License-Identifier: MIT
           74┆ pragma solidity ^0.8.14;
           75┆
           76┆ contract HelloWorld {
           77┆     function get()public pure returns (string memory){
           78┆         return 'Hello Contracts';
           79┆     }
           80┆ }`
            ⋮┆----------------------------------------
           73┆   code: string = `// SPDX-License-Identifier: MIT
           74┆ pragma solidity ^0.8.14;
           75┆
           76┆ contract HelloWorld {
           77┆     function get()public pure returns (string memory){
           78┆         return 'Hello Contracts';
           79┆     }
           80┆ }`
   
    ❯❱ rules.javascript.lang.security.audit.unsafe-dynamic-method
          Using non-static data to retrieve and run functions from the object is dangerous. If the data is
          user-controlled, it may allow executing arbitrary code.                                         
                                                                                                          
          221┆ const transaction = await contract.functions[func.name](
          222┆   ...inputs,
          223┆   transactionOptions
          224┆ )
                                            
    /src/frontend/src/assets/i18n/pl_PL.json
     ❱ rules.generic.secrets.gitleaks.generic-api-key
          A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is   
          not recommended to store credentials in source-code, as this risks secrets being leaked  and used by
          either an internal or external malicious adversary. It is recommended to use  environment variables 
          to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware       
          Security Module). This rule can introduce a lot of false positives,  it is not recommended to be    
          used in PR comments.                                                                                
                                                                                                              
          464┆ "BTN_AUTHENTICATE": "Uwierzytelnij",
                                                           
    /src/frontend/src/hacking-instructor/helpers/helpers.ts
    ❯❱ rules.javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop
          Possibility of prototype polluting function detected. By adding or modifying attributes of an object
          prototype, it is possible to create attributes that exist on every object, or replace critical      
          attributes with malicious ones. This can be problematic if the software depends on existence or non-
          existence of certain attributes, or uses pre-defined attributes of object prototype (such as        
          hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, 
          using an object without prototypes (via Object.create(null) ), blocking modifications of attributes 
          that resolve to object prototype, using Map instead of object.                                      
                                                                                                              
           38┆ replacementValue = replacementValue[property]
   
     ❱ rules.javascript.lang.correctness.useless-assignment
          `delay` is assigned twice; the first assignment is useless
                                                                    
          142┆ let delay = playbackDelays[config.hackingInstructor.hintPlaybackSpeed]
          143┆ delay ??= 1.0
                                                 
    /src/frontend/src/hacking-instructor/index.ts
   ❯❯❱ rules.javascript.browser.security.insecure-document-method
          User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern
          that can lead to XSS vulnerabilities                                                                
                                                                                                              
          122┆ textBox.innerHTML = snarkdown(hint.text)
   
   ❯❯❱ rules.javascript.browser.security.insecure-innerhtml
          User controlled data in a `textBox.innerHTML` is an anti-pattern that can lead to XSS
          vulnerabilities                                                                      
                                                                                               
          122┆ textBox.innerHTML = snarkdown(hint.text)
                                
    /src/lib/codingChallenges.ts
     ❱ rules.javascript.lang.correctness.missing-template-string-indicator
          This looks like a JavaScript template string. Are you missing a '$' in front of '{...}'?
                                                                                                  
           59┆ const snippets = source.match(`[/#]{0,2} vuln-code-snippet          
               start.*${challengeKey}([^])*vuln-code-snippet end.*${challengeKey}`)
            ⋮┆----------------------------------------
           59┆ const snippets = source.match(`[/#]{0,2} vuln-code-snippet          
               start.*${challengeKey}([^])*vuln-code-snippet end.*${challengeKey}`)
   
    ❯❱ rules.javascript.lang.security.audit.detect-non-literal-regexp
          RegExp() called with a `challengeKey` function argument, this might allow an attacker to cause a    
          Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main      
          thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on
          user-controlled input, consider performing input validation or use a regex checking/sanitization    
          library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear      
          vulnerable to ReDoS.                                                                                
                                                                                                              
           76┆ if (new RegExp(`vuln-code-snippet vuln-line.*${challengeKey}`).exec(lines[i]) != null) {
            ⋮┆----------------------------------------
           78┆ } else if (new RegExp(`vuln-code-snippet neutral-line.*${challengeKey}`).exec(lines[i]) !=
               null) {                                                                                   
                          
    /src/lib/insecurity.ts
     ❱ rules.generic.secrets.gitleaks.private-key
          A gitleaks private-key was detected which attempts to identify hard-coded credentials. It is not  
          recommended to store credentials in source-code, as this risks secrets being leaked and used by   
          either an internal or external malicious adversary. It is recommended to use environment variables
          to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware      
          Security Module).                                                                                 
                                                                                                            
           23┆ const privateKey = '-----BEGIN RSA PRIVATE KEY-----                                        
               \r\nMIICXAIBAAKBgQDNwqLEe9wgTXCbC7+RPdDbBbeqjdbs4kOPOIGzqLpXvJXlxxW8iMz0EaM4BKUqYsIa+ndv3NA
               n2RxCd5ubVdJJcX43zO6Ko0TFEZx/65gY3BE0O6syCEmUP4qbSd6exou/F+WTISzbQ5FBVPVmhnYhG/kpwt/cIxK5iU
               n5hm+4tQIDAQABAoGBAI+8xiPoOrA+KMnG/T4jJsG6TsHQcDHvJi7o1IKC/hnIXha0atTX5AUkRRce95qSfvKFweXdJ
               XSQ0JMGJyfuXgU6dI0TcseFRfewXAa/ssxAC+iUVR6KUMh1PE2wXLitfeI6JLvVtrBYswm2I7CtY0q8n5AGimHWVXJP
               LfGV7m0BAkEA+fqFt2LXbLtyg6wZyxMA/cnmt5Nt3U2dAu77MzFJvibANUNHE4HPLZxjGNXN+a6m0K6TD4kDdh5HfUY
               LWWRBYQJBANK3carmulBwqzcDBjsJ0YrIONBpCAsXxk8idXb8jL9aNIg15Wumm2enqqObahDHB5jnGOLmbasizvSVqy
               pfM9UCQCQl8xIqy+YgURXzXCN+kwUgHinrutZms87Jyi+D8Br8NY0+Nlf+zHvXAomD2W5CsEK7C+8SLBr3k/TsnRWHJ
               uECQHFE9RA2OP8WoaLPuGCyFXaxzICThSRZYluVnWkZtxsBhW2W8z1b8PvWUE7kMy7TnkzeJS2LSnaNHoyxi7IaPQUC
               QCwWU4U+v4lD7uYBw00Ga/xt+7+UqFPlPVdz1yyr4q24Zxaw0LgmuEvgU5dycq8N7JxjTubX0MIRR+G9fmDBBl8=\r\
               n-----END RSA PRIVATE KEY-----'                                                            
   
    ❯❱ rules.javascript.lang.security.audit.hardcoded-hmac-key
          Detected a hardcoded hmac key. Avoid hardcoding secrets and consider using an alternate option such
          as reading the secret from a config file or using an environment variable.                         
                                                                                                             
           44┆ export const hmac = (data: string) => crypto.createHmac('sha256',
               'pa4qacea4VK9t9nGv7yZtwmj').update(data).digest('hex')           
   
    ❯❱ rules.javascript.jsonwebtoken.security.hardcoded-jwt-secret
          A hard-coded credential was detected. It is not recommended to store credentials in source-code, as
          this risks secrets being leaked and used by either an internal or external malicious adversary. It 
          is recommended to use environment variables to securely provide credentials or retrieve credentials
          from a secure vault or HSM (Hardware Security Module).                                             
                                                                                                             
           56┆ export const authorize = (user = {}) => jwt.sign(user, privateKey, { expiresIn: '6h',
               algorithm: 'RS256' })                                                                
   
    ❯❱ rules.javascript.lang.security.audit.hardcoded-hmac-key
          Detected a hardcoded hmac key. Avoid hardcoding secrets and consider using an alternate option such
          as reading the secret from a config file or using an environment variable.                         
                                                                                                             
          152┆ const hmac = crypto.createHmac('sha256', privateKey)
                                            
    /src/lib/startup/customizeApplication.ts
    ❯❱ rules.javascript.lang.security.html-in-template-string
          This template literal looks like HTML and has interpolated variables. These variables are not HTML-
          encoded by default. If the variables contain HTML tags, these may be interpreted by the browser,   
          resulting in cross-site scripting (XSS).                                                           
                                                                                                             
           84┆ const title = `<title>${config.get<string>('application.name')}</title>`
                                      
    /src/lib/startup/validateConfig.ts
     ❱ rules.javascript.lang.correctness.missing-template-string-indicator
          This looks like a JavaScript template string. Are you missing a '$' in front of '{...}'?
                                                                                                  
          114┆ logger.warn(`Product ${colors.italic(product.name)} is used as ${appliedSpecials.map(({   
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          114┆ logger.warn(`Product ${colors.italic(product.name)} is used as ${appliedSpecials.map(({   
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          114┆ logger.warn(`Product ${colors.italic(product.name)} is used as ${appliedSpecials.map(({   
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          114┆ logger.warn(`Product ${colors.italic(product.name)} is used as ${appliedSpecials.map(({   
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          114┆ logger.warn(`Product ${colors.italic(product.name)} is used as ${appliedSpecials.map(({   
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          162┆ logger.warn(`Memory ${colors.italic(memory.caption)} is used as ${appliedSpecials.map(({  
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          162┆ logger.warn(`Memory ${colors.italic(memory.caption)} is used as ${appliedSpecials.map(({  
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          162┆ logger.warn(`Memory ${colors.italic(memory.caption)} is used as ${appliedSpecials.map(({  
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          162┆ logger.warn(`Memory ${colors.italic(memory.caption)} is used as ${appliedSpecials.map(({  
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
            ⋮┆----------------------------------------
          162┆ logger.warn(`Memory ${colors.italic(memory.caption)} is used as ${appliedSpecials.map(({  
               name }) => `${colors.italic(name)}`).join(' and ')} but can only be used for one challenge
               (${colors.red('NOT OK')})`)                                                               
                           
    /src/routes/b2bOrder.ts
    ❯❱ rules.javascript.express.security.audit.express-detect-notevil-usage
          Detected usage of the `notevil` package, which is unmaintained and has vulnerabilities. Using any 
          sort of `eval()` functionality can be very dangerous, but if you must, the `eval` package is an up
          to date alternative. Be sure that only trusted input reaches an `eval()` function.                
                                                                                                            
           23┆ vm.runInContext('safeEval(orderLinesData)', sandbox, { timeout: 2000 })
                          
    /src/routes/captcha.ts
    ❯❱ rules.javascript.browser.security.eval-detected
          Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this 
          content can be input from outside the program, this may be a code injection vulnerability. Ensure
          evaluated content is not definable by external sources.                                          
                                                                                                           
           23┆ const answer = eval(expression).toString() // eslint-disable-line no-eval
                          
    /src/routes/chatbot.ts
    ❯❱ rules.javascript.lang.security.audit.unsafe-dynamic-method
          Using non-static data to retrieve and run functions from the object is dangerous. If the data is
          user-controlled, it may allow executing arbitrary code.                                         
                                                                                                          
          101┆ res.status(200).json(await botUtils[response.handler](req.body.query, user))
   
     ❱ rules.javascript.lang.correctness.eqeq-is-bad
          Detected a useless comparison operation `bot == bot` or `bot != bot`. This operation is always true.
          If testing for floating point NaN, use `math.isnan`, or `cmath.isnan` if the number is complex.     
                                                                                                              
          159┆ if (bot == null) {
   
    ❯❱ rules.javascript.express.security.injection.raw-html-format
          User data flows into the host portion of this manually-constructed HTML. This can introduce a Cross-
          Site-Scripting (XSS) vulnerability if this comes from user-provided input. Consider using a         
          sanitization library such as DOMPurify to sanitize the HTML within.                                 
                                                                                                              
          197┆ body: bot.training.state ? bot.greet(`${user.id}`) :                                     
               `${config.get<string>('application.chatBot.name')} isn't ready at the moment, please wait
               while I set things up`                                                                   
                             
    /src/routes/fileServer.ts
    ❯❱ rules.javascript.express.security.audit.express-res-sendfile
          The application processes user-input, this is passed to res.sendFile which can allow an attacker to
          arbitrarily read files on the system through path traversal. It is recommended to perform input    
          validation in addition to canonicalizing the path. This allows you to validate the path against the
          intended directory it should be accessing.                                                         
                                                                                                             
           33┆ res.sendFile(path.resolve('ftp/', file))
                             
    /src/routes/fileUpload.ts
    ❯❱ rules.javascript.express.security.audit.express-libxml-vm-noent
          Detected use of parseXml() function with the `noent` field set to `true`. This can lead to an XML
          External Entities (XXE) attack if untrusted data is passed into it.                              
                                                                                                           
           83┆ const xmlDoc = vm.runInContext('libxml.parseXml(data, { noblanks: true, noent: true,
               nocdata: true })', sandbox, { timeout: 2000 })                                      
                            
    /src/routes/keyServer.ts
    ❯❱ rules.javascript.express.security.audit.express-res-sendfile
          The application processes user-input, this is passed to res.sendFile which can allow an attacker to
          arbitrarily read files on the system through path traversal. It is recommended to perform input    
          validation in addition to canonicalizing the path. This allows you to validate the path against the
          intended directory it should be accessing.                                                         
                                                                                                             
           14┆ res.sendFile(path.resolve('encryptionkeys/', file))
                                
    /src/routes/logfileServer.ts
    ❯❱ rules.javascript.express.security.audit.express-res-sendfile
          The application processes user-input, this is passed to res.sendFile which can allow an attacker to
          arbitrarily read files on the system through path traversal. It is recommended to perform input    
          validation in addition to canonicalizing the path. This allows you to validate the path against the
          intended directory it should be accessing.                                                         
                                                                                                             
           14┆ res.sendFile(path.resolve('logs/', file))
                        
    /src/routes/login.ts
    ❯❱ rules.javascript.sequelize.security.audit.sequelize-raw-query
          Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL
          Injection. Data replacement or data binding should be used. See                                     
          https://sequelize.org/master/manual/raw-queries.html                                                
                                                                                                              
           34┆ models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND
               password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model:
               UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge           
               loginBenderChallenge loginJimChallenge                                                 
   
   ❯❯❱ rules.javascript.sequelize.security.audit.express-sequelize-injection
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
                                                                                                              
           34┆ models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND
               password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model:
               UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge           
               loginBenderChallenge loginJimChallenge                                                 
   
   ❯❯❱ rules.javascript.express.security.injection.tainted-sql-string
          Detected user input used to manually construct a SQL string. This is usually bad practice because 
          manual construction could accidentally result in a SQL injection. An attacker could use a SQL     
          injection to steal or modify contents of the database. Instead, use a parameterized query which is
          available by default in most database engines. Alternatively, consider using an object-relational 
          mapper (ORM) such as Sequelize which will protect your queries.                                   
                                                                                                            
           34┆ models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND
               password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model:
               UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge           
               loginBenderChallenge loginJimChallenge                                                 
   
     ❱ rules.generic.secrets.gitleaks.generic-api-key
          A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is   
          not recommended to store credentials in source-code, as this risks secrets being leaked  and used by
          either an internal or external malicious adversary. It is recommended to use  environment variables 
          to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware       
          Security Module). This rule can introduce a lot of false positives,  it is not recommended to be    
          used in PR comments.                                                                                
                                                                                                              
           65┆ challengeUtils.solveIf(challenges.oauthUserPasswordChallenge, () => { return req.body.email
               === 'bjoern.kimminich@gmail.com' && req.body.password ===                                  
               'bW9jLmxpYW1nQGhjaW5pbW1pay5ucmVvamI=' })                                                  
                                   
    /src/routes/quarantineServer.ts
    ❯❱ rules.javascript.express.security.audit.express-res-sendfile
          The application processes user-input, this is passed to res.sendFile which can allow an attacker to
          arbitrarily read files on the system through path traversal. It is recommended to perform input    
          validation in addition to canonicalizing the path. This allows you to validate the path against the
          intended directory it should be accessing.                                                         
                                                                                                             
           14┆ res.sendFile(path.resolve('ftp/quarantine/', file))
                           
    /src/routes/redirect.ts
    ❯❱ rules.javascript.express.security.audit.unknown-value-in-redirect
          It looks like 'toUrl' is read from user input and it is used to as a redirect. Ensure 'toUrl' is not
          externally controlled, otherwise this is an open redirect.                                          
                                                                                                              
           19┆ res.redirect(toUrl)
   
    ❯❱ rules.javascript.express.security.audit.express-open-redirect
          The application redirects to a URL specified by user-supplied input `query` that is not validated. 
          This could redirect users to malicious locations. Consider using an allow-list approach to validate
          URLs, or warn users they are being redirected to a third-party website.                            
                                                                                                             
           19┆ res.redirect(toUrl)
                         
    /src/routes/search.ts
    ❯❱ rules.javascript.sequelize.security.audit.sequelize-raw-query
          Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL
          Injection. Data replacement or data binding should be used. See                                     
          https://sequelize.org/master/manual/raw-queries.html                                                
                                                                                                              
           23┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR   
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-
               snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge                        
   
   ❯❯❱ rules.javascript.sequelize.security.audit.express-sequelize-injection
          Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if   
          the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it
          is recommended to use parameterized queries or prepared statements.                                 
                                                                                                              
           23┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR   
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-
               snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge                        
   
   ❯❯❱ rules.javascript.express.security.injection.tainted-sql-string
          Detected user input used to manually construct a SQL string. This is usually bad practice because 
          manual construction could accidentally result in a SQL injection. An attacker could use a SQL     
          injection to steal or modify contents of the database. Instead, use a parameterized query which is
          available by default in most database engines. Alternatively, consider using an object-relational 
          mapper (ORM) such as Sequelize which will protect your queries.                                   
                                                                                                            
           23┆ models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR   
               description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-
               snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge                        
                              
    /src/routes/userProfile.ts
    ❯❱ rules.javascript.browser.security.eval-detected
          Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this 
          content can be input from outside the program, this may be a code injection vulnerability. Ensure
          evaluated content is not definable by external sources.                                          
                                                                                                           
           62┆ username = eval(code) // eslint-disable-line no-eval
   
   ❯❯❱ rules.javascript.lang.security.audit.code-string-concat
          Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable
          this can lead to execution of arbitrary system commands in the context of your application process.
          Avoid `eval` whenever possible.                                                                    
                                                                                                             
           62┆ username = eval(code) // eslint-disable-line no-eval
                         
    /src/routes/verify.ts
    ❯❱ rules.javascript.lang.security.html-in-template-string
          This template literal looks like HTML and has interpolated variables. These variables are not HTML-
          encoded by default. If the variables contain HTML tags, these may be interpreted by the browser,   
          resulting in cross-site scripting (XSS).                                                           
                                                                                                             
          184┆ if (utils.contains(osaft.description, `<a                                          
               href="${config.get<string>('challenges.overwriteUrlForProductTamperingChallenge')}"
               target="_blank">`)) {                                                              
                               
    /src/routes/videoHandler.ts
    ❯❱ rules.javascript.lang.security.audit.unknown-value-with-script-tag
          Cannot determine what 'subs' is and it is used with a '<script>' tag. This could be susceptible to
          cross-site scripting (XSS). Ensure 'subs' is not externally controlled, or sanitize this data.    
                                                                                                            
           58┆ challengeUtils.solveIf(challenges.videoXssChallenge, () => { return utils.contains(subs,
               '</script><script>alert(`xss`)</script>') })                                            
            ⋮┆----------------------------------------
           71┆ compiledTemplate = compiledTemplate.replace('<script id="subtitle"></script>', '<script  
               id="subtitle" type="text/vtt" data-label="English" data-lang="en">' + subs + '</script>')
                  
    /src/server.ts
     ❱ rules.javascript.lang.security.audit.unsafe-formatstring
          Detected string concatenation with a non-literal variable in a util.format / console.log function.
          If an attacker injects a format specifier in the string, it will forge the log message. Try to use
          constant values for the format string.                                                            
                                                                                                            
          155┆ console.error('Error in timed startup function: ' + name, err)
   
    ❯❱ rules.javascript.express.security.audit.express-check-directory-listing
          Directory listing/indexing is enabled, which may lead to disclosure of sensitive directories and 
          files. It is recommended to disable directory listing unless it is a public resource. If you need
          directory listing, ensure that sensitive files are inaccessible when querying the resource.      
                                                                                                           
          269┆ app.use('/ftp', serveIndexMiddleware, serveIndex('ftp', { icons: true })) // vuln-code-
               snippet vuln-line directoryListingChallenge                                            
            ⋮┆----------------------------------------
          273┆ app.use('/.well-known', serveIndexMiddleware, serveIndex('.well-known', { icons: true,
               view: 'details' }))                                                                   
            ⋮┆----------------------------------------
          277┆ app.use('/encryptionkeys', serveIndexMiddleware, serveIndex('encryptionkeys', { icons:
               true, view: 'details' }))                                                             
            ⋮┆----------------------------------------
          281┆ app.use('/support/logs', serveIndexMiddleware, serveIndex('logs', { icons: true, view:
               'details' })) // vuln-code-snippet vuln-line accessLogDisclosureChallenge             
                                  
    /src/views/dataErasureForm.hbs
    ❯❱ rules.generic.html-templates.security.unquoted-attribute-var
          Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject
          custom JavaScript handlers. To fix this, add quotes around the template expression, like this: "{{
          expr }}".                                                                                         
                                                                                                            
           21┆ <input type="email" required placeholder={{userEmail}} name="email" id="email">
                                 
    /src/views/promotionVideo.pug
    ❯❱ rules.javascript.express.security.audit.xss.pug.template-explicit-unescape
          Detected an explicit unescape in a Pug template, using either '!=' or '!{...}'. If external data can
          reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If
          you must do this, ensure no external data can reach this location.                                  
                                                                                                              
           79┆ if (splitted.length != 2) {
